<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labyrinth-math // terminal</title>
    
    <!-- Base URL for relative assets (Icons, etc.) -->
    <base href="https://cdn.jsdelivr.net/gh/gn-math/gn-math.github.io@main/">
    
    <link rel="icon" type="image/png" href="favicon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon.png">
    <link rel="apple-touch-icon" href="/favicon.png">

    <!-- External Dependencies (Analytics, Ads - Note: These may be blocked by adblockers) -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5521219086088837" crossorigin="anonymous"></script>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-WX5VS54ZDW"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag() { dataLayer.push(arguments); }
        gtag('js', new Date());
        gtag('config', 'G-WX5VS54ZDW');
    </script>
    
    <!-- External Helper Script -->
    <script src="https://cdn.jsdelivr.net/gh/gn-math/gn-math.github.io@main/gnmath.js"></script>

    <style>
        :root {
            --primary-color: #00ff41; 
            --text-color: #00ff41;
            --background-color: #050505;
            --card-bg: #000000;
            --card-border: #00ff41;
            --shadow: rgba(0, 255, 65, 0.2);
            --popup-bg: #0a0a0a;
        }

        body {
            font-family: 'Courier New', Courier, monospace;
            margin: 0; padding: 0;
            background-color: var(--background-color);
            color: var(--text-color);
            overflow-x: hidden;
        }

        /* Scrollbar Styling */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #000; }
        ::-webkit-scrollbar-thumb { background: var(--primary-color); border-radius: 5px; }
        ::-webkit-scrollbar-thumb:hover { background: #00cc33; }

        header {
            background-color: #000;
            color: var(--primary-color);
            padding: 1rem;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 2px solid var(--primary-color);
            box-shadow: 0 4px 15px var(--shadow);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
            flex-wrap: wrap;
            gap: 15px;
        }

        .logo { 
            font-size: 1.5rem; 
            font-weight: bold; 
            letter-spacing: 2px; 
            text-shadow: 0 0 5px var(--primary-color);
        }

        .search-container { display: flex; gap: 10px; flex-wrap: wrap; }

        #searchBar, #sortOptions {
            padding: 0.5rem;
            background: #000;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
            font-family: inherit;
            outline: none;
        }

        #searchBar:focus, #sortOptions:focus {
            box-shadow: 0 0 5px var(--primary-color);
        }

        main { max-width: 1200px; margin: 0 auto; padding: 1rem; }

        #container, #featuredZones {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
            gap: 20px;
            margin-top: 1rem;
        }

        .zone-item {
            background-color: var(--card-bg);
            border: 1px solid var(--card-border);
            overflow: hidden;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .zone-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 0 15px var(--shadow);
        }

        .zone-item img {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
            filter: brightness(0.8) sepia(100%) hue-rotate(90deg) grayscale(0.5);
            transition: filter 0.3s;
        }

        .zone-item:hover img {
            filter: none;
        }

        .zone-item button {
            background-color: #000;
            color: var(--primary-color);
            border: none;
            padding: 10px;
            cursor: pointer;
            font-family: inherit;
            height: 60px;
            display: flex; align-items: center; justify-content: center; text-align: center;
            border-top: 1px solid var(--card-border);
            width: 100%;
            font-weight: bold;
        }

        /* Iframe Viewer Styling */
        #zoneViewer {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: var(--background-color);
            z-index: 1000;
            display: none; 
            flex-direction: column;
        }

        .zone-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: #000;
            border-bottom: 2px solid var(--primary-color);
            padding: 0.5rem 1rem;
        }

        .zone-controls {
            display: flex;
            gap: 10px;
        }

        .zone-controls button {
            background: transparent;
            border: 1px solid var(--primary-color);
            color: var(--primary-color);
            padding: 0.5rem;
            cursor: pointer;
            font-family: inherit;
            transition: background 0.2s, color 0.2s;
        }

        .zone-controls button:hover {
            background: var(--primary-color);
            color: #000;
        }

        #zoneFrame { flex-grow: 1; border: none; width: 100%; height: 100%; background: #fff; }

        /* Popup Styling */
        #popupOverlay {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background-color: rgba(0, 0, 0, 0.9);
            display: none;
            align-items: center; justify-content: center;
            z-index: 2000;
        }

        .popup { 
            background: #000; 
            border: 2px solid var(--primary-color); 
            width: 90%; 
            max-width: 500px; 
            box-shadow: 0 0 20px var(--shadow);
        }
        
        .popup-header { 
            background: var(--primary-color); 
            color: #000; 
            padding: 0.8rem 1rem; 
            display: flex; 
            justify-content: space-between; 
            align-items: center;
            font-weight: bold;
        }

        footer { 
            background: #000; 
            padding: 2rem 1rem; 
            text-align: center; 
            border-top: 1px solid var(--primary-color); 
            margin-top: 2rem; 
        }
        
        .footer-links { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .footer-links a, .footer-links label { color: var(--primary-color); text-decoration: none; cursor: pointer; }
        .footer-links a:hover, .footer-links label:hover { text-decoration: underline; }

        @media (max-width: 768px) {
            .header-content { flex-direction: column; align-items: stretch; }
            .search-container { flex-direction: column; }
            #container, #featuredZones { grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); }
            .zone-controls { flex-wrap: wrap; }
            .zone-controls button { flex: 1; }
        }
    </style>
</head>
<body class="dark-mode">
    <header>
        <div class="header-content">
            <div class="logo">Labyrinth-math // SYS</div>
            <div class="search-container">
                <input type="text" id="searchBar" placeholder="Search data..." oninput="filterZones()">
                <select id="sortOptions" onchange="sortZones()">
                    <option value="name">Name</option>
                    <option value="id">ID</option>
                    <option value="popular">Popular</option>
                </select>
            </div>
            <div class="control-buttons">
                <button id="settings" style="background:transparent; color:#00ff41; border:1px solid #00ff41; padding: 5px 15px; cursor:pointer; font-family: inherit;">Settings</button>
            </div>
        </div>
    </header>

    <main>
        <details id="featuredZonesWrapper" open>
            <summary id="allZonesSummary" style="cursor: pointer; font-weight: bold; font-size: 1.2rem; margin-bottom: 1rem;">Featured Zones</summary>
            <div id="featuredZones" class="zone-container"></div>
        </details>
        <br><hr style="border: 0.5px solid #00ff41; opacity: 0.3;"><br>
        <details id="allZonesWrapper" open>
            <summary id="allSummary" style="cursor: pointer; font-weight: bold; font-size: 1.2rem; margin-bottom: 1rem;">All Zones</summary>
            <div id="container">Connecting to server...</div>
        </details>
    </main>

    <div id="zoneViewer">
        <div class="zone-header">
            <div class="zone-title">
                <h2 id="zoneName" style="margin:0; font-size: 1.2rem;">zone</h2>
                <span id="zoneId" style="display: none;"></span>
                <a id="zoneAuthor" href="#" target="_blank" style="color:#00ff41; font-size: 0.8rem;">by Author</a>
            </div>
            <div class="zone-controls">
                <button onclick="fullscreenZone()">Fullscreen</button>
                <button onclick="aboutBlank()">New Tab</button>
                <button onclick="downloadZone()">Download</button>
                <button onclick="closeZone()">Close</button>
            </div>
        </div>
        <iframe id="zoneFrame"></iframe>
    </div>

    <div id="popupOverlay">
        <div class="popup">
            <div class="popup-header">
                <h3 id="popupTitle" style="margin:0;">Title</h3>
                <button id="popupClose" onclick="closePopup()" style="background:none; border:none; cursor:pointer; font-size:1.5rem; font-weight:bold;">Ã—</button>
            </div>
            <div id="popupBody" style="padding:1rem;"></div>
        </div>
    </div>

    <footer>
        <div class="footer-links">
            <a href="#" onclick="showContact(); return false;">Contact</a>
            <a href="#" onclick="loadPrivacy(); return false;">Privacy Policy</a>
            <a href="javascript:saveData()">Export Data</a>
            <label for="importData">Import Data</label>
            <input type="file" id="importData" style="display: none;" onchange="loadData(event)">
        </div>
        <div style="margin-top: 20px; font-size: 0.8rem; color: #008f24;">
            SYSTEM STATUS: ONLINE
        </div>
    </footer>

    <script>
        const container = document.getElementById('container');
        const zoneViewer = document.getElementById('zoneViewer');
        let zoneFrame = document.getElementById('zoneFrame');
        const searchBar = document.getElementById('searchBar');
        const sortOptions = document.getElementById('sortOptions');
        
        // Configuration URLS
        const zonesURL = "https://cdn.jsdelivr.net/gh/gn-math/assets@main/zones.json";
        const coverURL = "https://cdn.jsdelivr.net/gh/gn-math/covers@main";
        const htmlURL = "https://cdn.jsdelivr.net/gh/gn-math/html@main";
        
        let zones = [];
        let popularityData = {};
        const featuredContainer = document.getElementById('featuredZones');

        // FALLBACK DATA (In case the fetch fails due to blocking)
        const fallbackZones = [
            { id: 1, name: "2048", author: "Gabriele Cirulli", url: "https://play2048.co/", cover: "https://upload.wikimedia.org/wikipedia/commons/thumb/1/18/2048_logo.svg/1200px-2048_logo.svg.png", featured: true },
            { id: 2, name: "Minecraft Classic", author: "Mojang", url: "https://classic.minecraft.net/", cover: "https://upload.wikimedia.org/wikipedia/en/5/51/Minecraft_cover.png" },
            { id: 3, name: "Slope", author: "Y8", url: "https://slopegame.io", cover: "https://img.poki.com/cdn-cgi/image/quality=78,width=600,height=600,fit=cover,f=auto/8c067e2a9693341b55979326e0689b0d.png", featured: true }
        ];

        async function listZones() {
            try {
                container.innerHTML = "Accessing remote database...";
                const response = await fetch(zonesURL + "?t=" + Date.now());
                if (!response.ok) throw new Error("Network response was not ok");
                const json = await response.json();
                zones = json;
                if(zones.length > 0) zones[0].featured = true;
                
                await fetchPopularity();
                sortZones();
                checkURLParams();
            } catch (error) {
                console.warn("External JSON fetch failed, using fallback mode:", error);
                container.innerHTML = "Note: Remote database blocked or unreachable. Loaded fallback mode.";
                // Use fallback data if fetch fails
                zones = fallbackZones;
                displayFeaturedZones(zones.filter(z => z.featured));
                displayZones(zones);
            }
        }

        function checkURLParams() {
            const search = new URLSearchParams(window.location.search);
            const id = search.get('id');
            const embed = window.location.hash.includes("embed");
            if (id) {
                const zone = zones.find(zone => zone.id + '' == id + '');
                if (zone) {
                    if (embed) {
                        loadEmbedMode(zone);
                    } else {
                        openZone(zone);
                    }
                }
            }
        }

        function loadEmbedMode(zone) {
             if (zone.url.startsWith("http")) {
                window.open(zone.url, "_blank");
            } else {
                const url = zone.url.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
                fetch(url + "?t=" + Date.now()).then(response => response.text()).then(html => {
                    document.documentElement.innerHTML = html;
                    // Inject Back Button
                    const backBtn = document.createElement("button");
                    backBtn.innerText = "Return to System";
                    backBtn.style.position = "fixed";
                    backBtn.style.bottom = "10px";
                    backBtn.style.right = "10px";
                    backBtn.style.zIndex = "9999";
                    backBtn.onclick = () => window.location.href = window.location.pathname;
                    document.body.appendChild(backBtn);
                }).catch(error => alert("Failed to load zone: " + error));
            }
        }

        async function fetchPopularity() {
            try {
                const response = await fetch("https://data.jsdelivr.com/v1/stats/packages/gh/gn-math/html@main/files?period=year");
                const data = await response.json();
                data.forEach(file => {
                    const idMatch = file.name.match(/\/(\d+)\.html$/);
                    if (idMatch) {
                        const id = parseInt(idMatch[1]);
                        popularityData[id] = file.hits.total;
                    }
                });
            } catch (error) { popularityData[0] = 0; }
        }

        function sortZones() {
            const sortBy = sortOptions.value;
            if (sortBy === 'name') {
                zones.sort((a, b) => a.name.localeCompare(b.name));
            } else if (sortBy === 'id') {
                zones.sort((a, b) => a.id - b.id);
            } else if (sortBy === 'popular') {
                zones.sort((a, b) => (popularityData[b.id] || 0) - (popularityData[a.id] || 0));
            }
            zones.sort((a, b) => (a.id === -1 ? -1 : b.id === -1 ? 1 : 0));
            
            const featured = zones.filter(z => z.featured);
            displayFeaturedZones(featured);
            displayZones(zones);
        }

        function displayFeaturedZones(featuredZones) {
            featuredContainer.innerHTML = "";
            if (featuredZones.length === 0) {
                 featuredContainer.innerHTML = "<div style='padding:10px; color:#555;'>No featured zones available.</div>";
                 return;
            }
            
            featuredZones.forEach((file) => {
                const zoneItem = createZoneElement(file);
                featuredContainer.appendChild(zoneItem);
            });
            document.getElementById("allZonesSummary").textContent = `Featured Zones (${featuredZones.length})`;
            observeLazyImages('#featuredZones img.lazy-zone-img');
        }

        function displayZones(zonesList) {
            container.innerHTML = "";
            if (zonesList.length === 0) {
                container.innerHTML = "No zones found.";
            } else {
                document.getElementById("allSummary").textContent = `All Zones (${zonesList.length})`;
                zonesList.forEach((file) => {
                    const zoneItem = createZoneElement(file);
                    container.appendChild(zoneItem);
                });
            }
            observeLazyImages('img.lazy-zone-img');
        }

        function createZoneElement(file) {
            const zoneItem = document.createElement("div");
            zoneItem.className = "zone-item";
            zoneItem.onclick = () => openZone(file);

            const img = document.createElement("img");
            // Handle raw URLs vs template URLs
            let imgSrc = file.cover;
            if(imgSrc && imgSrc.includes("{COVER_URL}")) {
                imgSrc = imgSrc.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
            }
            
            img.dataset.src = imgSrc || "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='100' height='100' style='background:%23000'%3E%3Ctext x='50%25' y='50%25' fill='%2300ff41' dominant-baseline='middle' text-anchor='middle'%3E?%3C/text%3E%3C/svg%3E";
            img.src = "data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 1 1'%3E%3C/svg%3E"; // Placeholder
            img.alt = file.name;
            img.loading = "lazy";
            img.className = "lazy-zone-img";
            zoneItem.appendChild(img);

            const button = document.createElement("button");
            button.textContent = file.name;
            button.onclick = (event) => {
                event.stopPropagation();
                openZone(file);
            };
            zoneItem.appendChild(button);
            return zoneItem;
        }

        function observeLazyImages(selector) {
            const lazyImages = document.querySelectorAll(selector);
            const imageObserver = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        const img = entry.target;
                        img.src = img.dataset.src;
                        img.classList.remove("lazy-zone-img");
                        observer.unobserve(img);
                    }
                });
            }, { rootMargin: "100px", threshold: 0.1 });
            lazyImages.forEach(img => imageObserver.observe(img));
        }

        function filterZones() {
            const query = searchBar.value.toLowerCase();
            const filteredZones = zones.filter(zone => zone.name.toLowerCase().includes(query));
            if (query.length !== 0) {
                document.getElementById("featuredZonesWrapper").removeAttribute("open");
            }
            displayZones(filteredZones);
        }

        function openZone(file) {
            if (file.url.startsWith("http")) {
                // If it's a direct link (like fallback items), just open the iframe source
                if(zoneFrame.contentWindow) {
                     zoneFrame.src = file.url;
                } else {
                    zoneFrame = document.createElement("iframe");
                    zoneFrame.id = "zoneFrame";
                    zoneFrame.src = file.url;
                    zoneViewer.appendChild(zoneFrame);
                }
                
                showZoneViewer(file);
            } else {
                // Template URL logic
                const url = file.url.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
                fetch(url + "?t=" + Date.now()).then(response => response.text()).then(html => {
                    // Re-create iframe to clear previous state cleanly
                    if(document.getElementById("zoneFrame")) {
                        document.getElementById("zoneFrame").remove();
                    }
                    zoneFrame = document.createElement("iframe");
                    zoneFrame.id = "zoneFrame";
                    zoneViewer.appendChild(zoneFrame);

                    zoneFrame.contentDocument.open();
                    zoneFrame.contentDocument.write(html);
                    zoneFrame.contentDocument.close();
                    
                    showZoneViewer(file);

                    // Update URL
                    const urlObj = new URL(window.location);
                    urlObj.searchParams.set('id', file.id);
                    history.pushState(null, '', urlObj.toString());
                }).catch(error => {
                    alert("Failed to load zone source: " + error);
                });
            }
        }

        function showZoneViewer(file) {
            document.getElementById('zoneName').textContent = file.name;
            document.getElementById('zoneId').textContent = file.id;
            document.getElementById('zoneAuthor').textContent = "by " + file.author;
            if (file.authorLink) {
                document.getElementById('zoneAuthor').href = file.authorLink;
            }
            zoneViewer.style.display = "flex";
        }

        function aboutBlank() {
            // about:blank cloaking
            const newWindow = window.open("about:blank", "_blank");
            if(!newWindow) {
                alert("Pop-up blocked! Please allow pop-ups for this site.");
                return;
            }
            
            const currentZoneId = document.getElementById('zoneId').textContent;
            let zone = zones.find(z => z.id + '' === currentZoneId);
            
            if(!zone) return;

            if(zone.url.startsWith("http")) {
                newWindow.document.body.style.margin = "0";
                newWindow.document.body.innerHTML = `<iframe src="${zone.url}" style="width:100vw; height:100vh; border:none;"></iframe>`;
            } else {
                 const url = zone.url.replace("{COVER_URL}", coverURL).replace("{HTML_URL}", htmlURL);
                 fetch(url+"?t="+Date.now()).then(response => response.text()).then(html => {
                    newWindow.document.open();
                    newWindow.document.write(html);
                    newWindow.document.close();
                 });
            }
        }

        function closeZone() {
            zoneViewer.style.display = "none";
            // Stop iframe content (audio, etc)
            if(zoneFrame) zoneFrame.src = "about:blank";
            
            const url = new URL(window.location);
            url.searchParams.delete('id');
            history.pushState(null, '', url.toString());
        }

        function downloadZone() {
            const currentZoneId = document.getElementById('zoneId').textContent;
            let zone = zones.find(z => z.id + '' === currentZoneId);
            if(!zone) return;

            const downloadUrl = zone.url.startsWith("http") ? zone.url : zone.url.replace("{HTML_URL}", htmlURL);

            fetch(downloadUrl + "?t=" + Date.now()).then(res => res.text()).then(text => {
                const blob = new Blob([text], { type: "text/plain;charset=utf-8" });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = zone.name + ".html";
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            }).catch(e => alert("Cannot download this zone type directly."));
        }

        function fullscreenZone() {
            if (zoneFrame.requestFullscreen) { zoneFrame.requestFullscreen(); }
            else if (zoneFrame.mozRequestFullScreen) { zoneFrame.mozRequestFullScreen(); }
            else if (zoneFrame.webkitRequestFullscreen) { zoneFrame.webkitRequestFullscreen(); }
            else if (zoneFrame.msRequestFullscreen) { zoneFrame.msRequestFullscreen(); }
        }

        function saveData() {
            let data = JSON.stringify(localStorage) + "\n\n|\n\n" + document.cookie;
            const link = document.createElement("a");
            link.href = URL.createObjectURL(new Blob([data], { type: "text/plain" }));
            link.download = `${Date.now()}.data`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function loadData(event) {
            const file = event.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function (e) {
                const content = e.target.result;
                const [localStorageData, cookieData] = content.split("\n\n|\n\n");
                try {
                    const parsedData = JSON.parse(localStorageData);
                    for (let key in parsedData) { localStorage.setItem(key, parsedData[key]); }
                } catch (error) {}
                if (cookieData) {
                    const cookies = cookieData.split("; ");
                    cookies.forEach(cookie => { document.cookie = cookie; });
                }
                alert("Data loaded");
            };
            reader.readAsText(file);
        }

        function darkMode() { document.body.classList.toggle("dark-mode"); }

        function cloakIcon(url) {
            const link = document.querySelector("link[rel~='icon']");
            link.rel = "icon";
            link.href = (url + "").trim().length === 0 ? "favicon.png" : url;
            document.head.appendChild(link);
        }

        function cloakName(string) {
            document.title = (string + "").trim().length === 0 ? "Home" : string;
        }

        function tabCloak() {
            closePopup();
            document.getElementById('popupTitle').textContent = "Tab Cloak";
            const popupBody = document.getElementById('popupBody');
            popupBody.innerHTML = `
                <label style="font-weight: bold;">Set Tab Title:</label><br>
                <input type="text" placeholder="Enter new tab name..." oninput="cloakName(this.value)" style="width:100%; padding:5px; background:#000; color:#00ff41; border:1px solid #00ff41; margin:10px 0;">
                <br><br>
                <label style="font-weight: bold;">Set Tab Icon:</label><br>
                <input type="text" placeholder="Enter new tab icon URL..." oninput='cloakIcon(this.value)' style="width:100%; padding:5px; background:#000; color:#00ff41; border:1px solid #00ff41; margin:10px 0;">
            `;
            document.getElementById('popupOverlay').style.display = "flex";
        }

        const settingsBtn = document.getElementById('settings');
        settingsBtn.addEventListener('click', () => {
            document.getElementById('popupTitle').textContent = "Settings";
            const popupBody = document.getElementById('popupBody');
            popupBody.innerHTML = `
                <button onclick="darkMode()" style="width:100%; padding:10px; background:#000; color:#00ff41; border:1px solid #00ff41; cursor:pointer; margin-bottom:10px; font-family: inherit;">Toggle Theme (Flash)</button>
                <button onclick="tabCloak()" style="width:100%; padding:10px; background:#000; color:#00ff41; border:1px solid #00ff41; cursor:pointer; font-family: inherit;">Tab Cloak</button>
            `;
            document.getElementById('popupOverlay').style.display = "flex";
        });

        function showContact() {
            document.getElementById('popupTitle').textContent = "Contact";
            document.getElementById('popupBody').innerHTML = `<p>Discord: https://discord.gg/NAFw4ykZ7n</p><p>Email: gn.math.business@gmail.com</p>`;
            document.getElementById('popupOverlay').style.display = "flex";
        }

        function loadPrivacy() {
            document.getElementById('popupTitle').textContent = "Privacy Policy";
            document.getElementById('popupBody').innerHTML = `<div style="max-height: 300px; overflow-y: auto;"><h2>PRIVACY POLICY</h2><p>Data is stored locally on your device.</p></div>`;
            document.getElementById('popupOverlay').style.display = "flex";
        }

        function closePopup() { document.getElementById('popupOverlay').style.display = "none"; }

        const schoolList = ["deledao", "goguardian", "lightspeed", "linewize", "securly", ".edu/"];
        function isBlockedDomain(url) {
            try {
                const domain = new URL(url, location.origin).hostname + "/";
                return schoolList.some(school => domain.includes(school));
            } catch(e) { return false; }
        }

        const originalFetch = window.fetch;
        window.fetch = function (url, options) {
            if (isBlockedDomain(url)) { return Promise.reject(new Error("lam")); }
            return originalFetch.apply(this, arguments);
        };

        const originalOpen = XMLHttpRequest.prototype.open;
        XMLHttpRequest.prototype.open = function (method, url) {
            if (isBlockedDomain(url)) { return; }
            return originalOpen.apply(this, arguments);
        };

        HTMLCanvasElement.prototype.toDataURL = function () { return ""; };
        
        // Start System
        listZones();
    </script>
</body>
</html>
